<mat-card class="update-car-container">
    <h2>Modifier la voiture</h2>
    <form [formGroup]="updateForm" (ngSubmit)="updateCar()" class="update-car-form">
        <mat-form-field appearance="fill">
            <mat-label>Name</mat-label>
            <input matInput formControlName="name" placeholder="Enter car name" required>
            <mat-error *ngIf="updateForm.get('name')?.invalid && updateForm.get('name')?.touched">
                Name is required.
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label>Brand</mat-label>
            <mat-select formControlName="brand" required>
                <mat-option *ngFor="let brand of listOfBrands" [value]="brand">{{ brand }}</mat-option>
            </mat-select>
            <mat-error *ngIf="updateForm.get('brand')?.invalid && updateForm.get('brand')?.touched">
                Brand is required.
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label>Type</mat-label>
            <mat-select formControlName="type" required>
                <mat-option *ngFor="let type of listOfType" [value]="type">{{ type }}</mat-option>
            </mat-select>
            <mat-error *ngIf="updateForm.get('type')?.invalid && updateForm.get('type')?.touched">
                Type is required.
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label>Color</mat-label>
            <mat-select formControlName="color" required>
                <mat-option *ngFor="let color of listOfColor" [value]="color">{{ color }}</mat-option>
            </mat-select>
            <mat-error *ngIf="updateForm.get('color')?.invalid && updateForm.get('color')?.touched">
                Color is required.
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label>Transmission</mat-label>
            <mat-select formControlName="transmission" required>
                <mat-option *ngFor="let transmission of listOfTransmission" [value]="transmission">{{ transmission }}</mat-option>
            </mat-select>
            <mat-error *ngIf="updateForm.get('transmission')?.invalid && updateForm.get('transmission')?.touched">
                Transmission is required.
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label>Price</mat-label>
            <input matInput formControlName="price" type="number" placeholder="Enter price" required>
            <mat-error *ngIf="updateForm.get('price')?.invalid && updateForm.get('price')?.touched">
                Price is required.
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label>Description</mat-label>
            <textarea matInput formControlName="discription" placeholder="Enter description" required></textarea>
            <mat-error *ngIf="updateForm.get('discription')?.invalid && updateForm.get('discription')?.touched">
                Description is required.
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label>Year</mat-label>
            <input matInput formControlName="year" type="date" required>
            <mat-error *ngIf="updateForm.get('year')?.invalid && updateForm.get('year')?.touched">
                Year is required.
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label>Agency</mat-label>
            <mat-select formControlName="agencyId" required>
                <mat-option *ngFor="let agency of agencies" [value]="agency.id">{{ agency.name }}</mat-option>
            </mat-select>
            <mat-error *ngIf="updateForm.get('agencyId')?.invalid && updateForm.get('agencyId')?.touched">
                Agency is required.
            </mat-error>
        </mat-form-field>

        <input type="file" (change)="onFileSelected($event)">
        <img *ngIf="imagePreview" [src]="imagePreview" class="image-preview" />
        <img *ngIf="existingImg" [src]="existingImg" class="existing-image" />
        <button mat-raised-button color="primary" type="submit">Update Car</button>
    </form>
</mat-card>
